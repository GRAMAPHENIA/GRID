---
// Componente de sección de servicios del luthier

import type { Service } from '../../types/service';

interface Props {
  services: Service[];
}

const { services } = Astro.props;

// Función para formatear el precio mínimo
function formatPrice(service: Service): string {
  if (!service.priceRange) return 'Consultar';
  const { min, currency = 'EUR' } = service.priceRange;
  const symbol = currency === 'EUR' ? '€' : currency;
  return `Desde ${min}${symbol}`;
}

// SVG Icons minimalistas en color neutro
const constructionIcon = `<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#737373" stroke-width="1.5"><path d="M12 2L2 7v10c0 5.55 3.84 10 9 10s9-4.45 9-10V7L12 2z"/><path d="M12 22V12"/><path d="M8 15l4-4 4 4"/></svg>`;

const repairIcon = `<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#737373" stroke-width="1.5"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>`;

function getServiceIcon(iconName: string): string {
  const icons: Record<string, string> = {
    'construction': constructionIcon,
    'repair': repairIcon
  };
  return icons[iconName] || constructionIcon;
}
---

<section class="py-8 md:py-16 px-4 bg-pure-white">
  <div class="max-w-4xl mx-auto">
    <!-- Grid de servicios -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
      {services.map((service) => (
        <article class="bg-pure-white border border-neutral-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow duration-200 group">
          <!-- Contenido de la tarjeta -->
          <div class="p-6 md:p-8">
            <!-- Icono y categoría -->
            <div class="flex justify-between items-start mb-4">
              <div class="flex items-center gap-2 md:gap-3">
                <div class="flex-shrink-0" set:html={getServiceIcon(service.icon)} />
                <span class="text-neutral-600 font-medium text-xs md:text-sm uppercase tracking-wide">
                  {service.category === 'construction' ? 'Construcción' : 'Reparación'}
                </span>
              </div>
            </div>

            <!-- Nombre del servicio -->
            <h3 class="text-xl md:text-2xl font-bold text-almost-black mb-3 md:mb-4 group-hover:text-neutral-700 transition-colors duration-300">
              {service.name}
            </h3>

            <!-- Descripción -->
            <p class="text-neutral-600 mb-4 md:mb-6 leading-relaxed text-sm md:text-base">
              {service.description}
            </p>

            <!-- Información básica -->
            <div class="mb-4 md:mb-6 space-y-1 md:space-y-2">
              <p class="text-neutral-500 text-xs md:text-sm">
                <span class="font-medium text-neutral-700">Duración:</span> {service.duration}
              </p>
              <p class="text-neutral-500 text-xs md:text-sm">
                <span class="font-medium text-neutral-700">Precio:</span> {formatPrice(service)}
              </p>
            </div>

            <!-- Tags -->
            {service.tags && service.tags.length > 0 && (
              <div class="flex flex-wrap gap-1.5 md:gap-2 mb-4 md:mb-6">
                {service.tags.map((tag) => (
                  <span class="px-2 md:px-3 py-1 bg-neutral-100 text-neutral-700 text-xs rounded-full border border-neutral-200">
                    {tag}
                  </span>
                ))}
              </div>
            )}

            <!-- Botón consultar -->
            <div class="pt-3 md:pt-4 border-t border-neutral-100">
              <a 
                href="/contact" 
                class="inline-flex items-center gap-2 px-4 md:px-6 py-2 bg-almost-black text-pure-white rounded-full font-medium hover:bg-neutral-800 transition-colors duration-200 text-sm"
                aria-label={`Consultar sobre ${service.name}`}
              >
                Consultar
                <span class="text-sm">→</span>
              </a>
            </div>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>